<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Debugging Revise · Revise.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Revise.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Home</a></li><li><a class="toctext" href="config.html">Configuration</a></li><li><a class="toctext" href="limitations.html">Limitations</a></li><li class="current"><a class="toctext" href="debugging.html">Debugging Revise</a><ul class="internal"><li><a class="toctext" href="#Turning-on-logging-1">Turning on logging</a></li><li><a class="toctext" href="#Capturing-the-logs-and-submitting-them-with-your-bug-report-1">Capturing the logs and submitting them with your bug report</a></li><li><a class="toctext" href="#The-structure-of-the-logs-1">The structure of the logs</a></li><li><a class="toctext" href="#A-complete-debugging-demo-1">A complete debugging demo</a></li></ul></li><li><a class="toctext" href="internals.html">How Revise works</a></li><li><a class="toctext" href="user_reference.html">User reference</a></li><li><a class="toctext" href="dev_reference.html">Developer reference</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="debugging.html">Debugging Revise</a></li></ul><a class="edit-page" href="https://github.com/timholy/Revise.jl/blob/master/docs/src/debugging.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Debugging Revise</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Debugging-Revise-1" href="#Debugging-Revise-1">Debugging Revise</a></h1><p>If Revise isn&#39;t behaving the way you expect it to, it can be useful to examine the decisions it made. Revise supports Julia&#39;s <a href="https://docs.julialang.org/en/stable/stdlib/Logging/">Logging framework</a> and can optionally record its decisions in a format suitable for later inspection. What follows is a simple series of steps you can use to turn on logging, capture messages, and then submit them with a bug report. Alternatively, more advanced developers may want to examine the logs themselves to determine the source of Revise&#39;s error, and for such users a few tips about interpreting the log messages are also provided below.</p><h2><a class="nav-anchor" id="Turning-on-logging-1" href="#Turning-on-logging-1">Turning on logging</a></h2><p>Currently, the best way to turn on logging is within a running Julia session:</p><pre><code class="language-julia-repl">julia&gt; rlogger = Revise.debug_logger()
Revise.ReviseLogger(Revise.LogRecord[], Debug)</code></pre><p>You&#39;ll use <code>rlogger</code> at the end to retrieve the logs.</p><p>Now carry out the series of julia commands and code edits that reproduces the problem.</p><h2><a class="nav-anchor" id="Capturing-the-logs-and-submitting-them-with-your-bug-report-1" href="#Capturing-the-logs-and-submitting-them-with-your-bug-report-1">Capturing the logs and submitting them with your bug report</a></h2><p>Once all the revisions have been triggered and the mistake has been reproduced, it&#39;s time to capture the logs. To capture all the logs, use</p><pre><code class="language-julia">julia&gt; logs = filter(r-&gt;r.level==Debug, rlogger.logs);</code></pre><p>You can capture just the log events that recorded a difference between two versions of the same file with</p><pre><code class="language-julia">julia&gt; log = Revise.diffs(rlogger)</code></pre><p>or just the changes that Revise made to running code with</p><pre><code class="language-julia">julia&gt; logs = Revise.actions(rlogger)</code></pre><p>You can either let these print to the console and copy/paste the text output into the issue, or if they are extensive you can save <code>logs</code> to a file (e.g., in JLD2 format) and upload the file somewhere.</p><p>See also <a href="debugging.html#A-complete-debugging-demo-1">A complete debugging demo</a> below.</p><h2><a class="nav-anchor" id="The-structure-of-the-logs-1" href="#The-structure-of-the-logs-1">The structure of the logs</a></h2><p>For those who want to do a little investigating on their own, it may be helpful to know that Revise&#39;s core decisions are captured in the group called &quot;Action,&quot; and they come in three flavors:</p><ul><li>log entries with message <code>&quot;Eval&quot;</code> signify a call to <code>eval</code>; for these events, keyword <code>:deltainfo</code> has value <code>(mod, expr)</code> where <code>mod</code> is the module of evaluation and <code>expr</code> is a <a href="dev_reference.html#Revise.RelocatableExpr"><code>Revise.RelocatableExpr</code></a> containing the expression that was evaluated.</li><li>log entries with message <code>&quot;DeleteMethod&quot;</code> signify a method deletion; for these events, keyword <code>:deltainfo</code> has value <code>(sigt, methsummary)</code> where <code>sigt</code> is the signature of the method that Revise <em>intended</em> to delete and <code>methsummary</code> is a <a href="dev_reference.html#Revise.MethodSummary"><code>MethodSummary</code></a> of the method that Revise actually found to delete.</li><li>log entries with message <code>&quot;LineOffset&quot;</code> correspond to updates to Revise&#39;s own internal estimates of how far a given method has become displaced from the line number it occupied when it was last evaluated. For these events, <code>:deltainfo</code> has value <code>(sigt, newlineno, oldoffset=&gt;newoffset)</code>.</li></ul><p>If you&#39;re debugging mistakes in method creation/deletion, the <code>&quot;LineOffset&quot;</code> events may be distracting; by default <a href="user_reference.html#Revise.actions"><code>Revise.actions</code></a> excludes these events.</p><p>Note that Revise records the time of each revision, which can sometimes be useful in determining which revisions occur in conjunction with which user actions. If you want to make use of this, it can be handy to capture the start time with <code>tstart = time()</code> before commencing on a session.</p><p>See <a href="user_reference.html#Revise.debug_logger"><code>Revise.debug_logger</code></a> for information on groups besides &quot;Action.&quot; One part</p><h2><a class="nav-anchor" id="A-complete-debugging-demo-1" href="#A-complete-debugging-demo-1">A complete debugging demo</a></h2><p>From within Revise&#39;s <code>test/</code> directory, try the following:</p><pre><code class="language-julia">julia&gt; rlogger = Revise.debug_logger();

shell&gt; cp revisetest.jl /tmp/

julia&gt; includet(&quot;/tmp/revisetest.jl&quot;)

julia&gt; ReviseTest.cube(3)
81

shell&gt; cp revisetest_revised.jl /tmp/revisetest.jl

julia&gt; ReviseTest.cube(3)
27

julia&gt; rlogger.logs
8-element Array{Revise.LogRecord,1}:
 Revise.LogRecord(Debug, Diff, Parsing, Revise_1dfe9141, &quot;/home/tim/.julia/dev/Revise/src/Revise.jl&quot;, 214, (activemodule=(:Main,), newexprs=Set(Revise.RelocatableExpr[]), oldexprs=Set(Revise.RelocatableExpr[])))
 Revise.LogRecord(Debug, Diff, Parsing, Revise_1dfe9142, &quot;/home/tim/.julia/dev/Revise/src/Revise.jl&quot;, 214, (activemodule=(:Main, :ReviseTest), newexprs=Set(Revise.RelocatableExpr[:(fourth(x) = begin
          x ^ 4
      end), :(cube(x) = begin
          x ^ 3
      end)]), oldexprs=Set(Revise.RelocatableExpr[:(cube(x) = begin
          x ^ 4
      end)])))
 Revise.LogRecord(Debug, Eval, Action, Revise_443cc0b6, &quot;/home/tim/.julia/dev/Revise/src/Revise.jl&quot;, 270, (time=1.535105837129072e9, deltainfo=(Main.ReviseTest, :(cube(x) = begin
          x ^ 3
      end))))
 Revise.LogRecord(Debug, Eval, Action, Revise_443cc0b7, &quot;/home/tim/.julia/dev/Revise/src/Revise.jl&quot;, 270, (time=1.535105837152789e9, deltainfo=(Main.ReviseTest, :(fourth(x) = begin
          x ^ 4
      end))))
 Revise.LogRecord(Debug, Diff, Parsing, Revise_1dfe9143, &quot;/home/tim/.julia/dev/Revise/src/Revise.jl&quot;, 214, (activemodule=(:Main, :ReviseTest, :Internal), newexprs=Set(Revise.RelocatableExpr[:(mult3(x) = begin
          3x
      end)]), oldexprs=Set(Revise.RelocatableExpr[:(mult4(x) = begin
          -x
      end), :(mult3(x) = begin
          4x
      end)])))
 Revise.LogRecord(Debug, LineOffset, Action, Revise_3e9f6659, &quot;/home/tim/.julia/dev/Revise/src/Revise.jl&quot;, 229, (time=1.535105837187501e9, deltainfo=(Any[Tuple{typeof(mult2),Any}], 13, 0 =&gt; 2)))
 Revise.LogRecord(Debug, Eval, Action, Revise_443cc0b8, &quot;/home/tim/.julia/dev/Revise/src/Revise.jl&quot;, 270, (time=1.535105837214e9, deltainfo=(Main.ReviseTest.Internal, :(mult3(x) = begin
          3x
      end))))
 Revise.LogRecord(Debug, DeleteMethod, Action, Revise_04f4de6f, &quot;/home/tim/.julia/dev/Revise/src/Revise.jl&quot;, 251, (time=1.535105837214255e9, deltainfo=(Tuple{typeof(Main.ReviseTest.Internal.mult4),Any}, MethodSummary(:mult4, :Internal, Symbol(&quot;/tmp/revisetest.jl&quot;), 13, Tuple{typeof(Main.ReviseTest.Internal.mult4),Any}))))</code></pre><p>In addition to the &quot;Action&quot; items, you can see other entries that record the &quot;Diff&quot;s encountered by Revise during revision.</p><p>In rare cases it might be helpful to independently record the sequence of edits to the file. You can make copies <code>cp editedfile.jl &gt; /tmp/version1.jl</code>, edit code, <code>cp editedfile.jl &gt; /tmp/version2.jl</code>, etc. <code>diff version1.jl version2.jl</code> can be used to capture a compact summary of the changes and pasted into the bug report.</p><footer><hr/><a class="previous" href="limitations.html"><span class="direction">Previous</span><span class="title">Limitations</span></a><a class="next" href="internals.html"><span class="direction">Next</span><span class="title">How Revise works</span></a></footer></article></body></html>
